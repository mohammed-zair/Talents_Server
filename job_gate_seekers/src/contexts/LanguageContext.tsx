import React, { createContext, useContext, useEffect, useMemo, useState } from "react";
import type { Language } from "../types/api";

type Dict = Record<string, string>;

type LanguageContextValue = {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string) => string;
};

const dictionary: Record<Language, Dict> = {
  en: {
    appTitle: "Talents We Trust | Job Seeker",
    pulse: "The Pulse",
    opportunities: "Opportunity Map",
    cvLab: "CV Lab",
    aiConsultant: "AI Consultant",
    aiConsultantIntro: "Build your CV with AI, then preview, refine, and export.",
    showSessions: "Show sessions",
    hideSessions: "Hide sessions",
    previewEmpty: "Keep chatting to build your CV.",
    exportDisabledHint: "Generate a preview to enable export.",
    insightsEmpty: "Insights will appear after the AI generates your CV.",
    startCareerAdvisor: "Career Advisor",
    startMockInterview: "Mock Interview",
    sessions: "Sessions",
    noSessionsYet: "No sessions yet. Start a new one to build your CV.",
    sessionLabelCareer: "Career Advisor",
    sessionLabelMock: "Mock Interview",
    lastMessage: "Last message",
    chatPanel: "Conversation",
    insightsPanel: "Insights",
    previewPanel: "CV Preview",
    exportPanel: "Export",
    exportPdf: "Download PDF",
    exportDocx: "Download DOCX",
    exportFailed: "Export failed. Please try again.",
    previewLoading: "Loading preview...",
    previewFailed: "Preview unavailable.",
    startFailed: "Failed to start session.",
    sendFailed: "Failed to send message.",
    sessionsLoadFailed: "Failed to load sessions.",
    chatEmpty: "Start a new session to build your CV with AI.",
    messageLabel: "Your message",
    selectSessionHint: "Select a session to continue.",
    market: "Market",
    consultants: "Consultants",
    applications: "Applications",
    profile: "Profile",
    settings: "Settings",
    searchPlaceholder: "Search jobs, companies, skills...",
    premiumUpgrade: "Premium Upgrade",
    login: "Login",
    register: "Create account",
    forgotPassword: "Forgot password",
    resetPassword: "Reset password",
    email: "Email",
    password: "Password",
    fullName: "Full name",
    phone: "Phone",
    submit: "Submit",
    logout: "Logout",
    atsHealth: "ATS Health",
    applicationFunnel: "Application Funnel",
    skillRadar: "Skill Radar",
    quickApply: "Quick Apply + Smart Pitch",
    aiStudio: "AI Studio",
    mockInterview: "Mock Interview Mode",
    welcomeBack: "Welcome Back",
    accessWorkspace: "Access your seeker workspace.",
    createJobSeekerAccount: "Create Job Seeker Account",
    registrationWorkflow: "From registration to applications in one workflow.",
    loginFailed: "Login failed",
    registrationFailed: "Registration failed",
    authFailed: "Failed",
    resetLinkSent: "If the email exists, a reset link has been sent.",
    passwordResetDone: "Password reset completed.",
    createAccount: "Create account",
    alreadyHaveAccount: "Already have an account?",
    forgotPasswordQ: "Forgot password?",
    sendResetLink: "Send reset link",
    haveTokenResetHere: "Have token already? Reset here",
    resetToken: "Reset Token",
    newPassword: "New Password",
    resetPasswordBtn: "Reset password",
    backToLogin: "Back to login",
    authTagline: "AI-Powered Career Intelligence",
    authHeadline: "Professional Job Seeker Command Center",
    authDescription: "Registration, CV Lab, AI consultant, market discovery, and premium insights.",
    goodMorning: "Good morning",
    seeker: "Seeker",
    profileMatchPrefix: "Your profile is a",
    profileMatchMiddle: "Match for",
    profileMatchSuffix: "new roles.",
    goToCvLab: "Go to CV Lab",
    browseJobs: "Browse jobs",
    startAiConsultant: "Start AI Consultant",
    currentCvStrength: "Current CV strength",
    applied: "Applied",
    interview: "Interview",
    offer: "Offer",
    marketLabel: "Market",
    opportunitiesTitle: "Opportunity Map",
    opportunitiesSubtitle: "Infinite smart cards with Match Intensity and Quick Apply.",
    apply: "Apply",
    viewDetails: "View details",
    matchUnavailable: "Match score coming soon",
    jobsLoadFailed: "Failed to load jobs.",
    noJobsFound: "No jobs found.",
    saved: "Saved",
    saveFailed: "Failed to save job.",
    jobDetailsFailed: "Failed to load job details.",
    jobDescription: "Description",
    jobRequirements: "Requirements",
    formLoadFailed: "Failed to load application form.",
    externalFormNote: "This job uses an external application form.",
    openExternalForm: "Open external form",
    selectOption: "Select an option",
    fileFieldNote: "Provide a link or reference (file upload not required).",
    coverLetter: "Cover letter",
    coverLetterPlaceholder: "Write a short cover letter...",
    chooseCv: "Choose a CV",
    selectCv: "Select a CV",
    cvRequired: "A CV is required for this application.",
    submitApplication: "Submit application",
    cancel: "Cancel",
    close: "Close",
    applicationSubmitted: "Application submitted successfully.",
    applyFailed: "Application failed. Please try again.",
    fieldRequired: "Field required",


    uploadCvFirst: "Upload CV first in CV Lab",
    quickApplySuccess: "Quick apply submitted with Smart Pitch.",
    quickApplyFailed: "Quick apply failed",
    match: "Match",
    company: "Company",
    remote: "Remote",
    save: "Save",
    loadMore: "Load More",
    cvPreview: "CV Preview",
    cvLabLeftHint: "Manage uploaded CV files, then run full AI analysis on the selected one.",
    cvLabRightHint: "Paste specific bullet points here for quick wording feedback.",
    cvTitle: "CV Title",
    cvTitlePlaceholder: "e.g. Senior Backend CV - 2026",
    uploadCv: "Upload CV",
    previewCv: "Preview CV",
    deleteCv: "Delete CV",
    confirmDeleteCv: "Are you sure you want to delete this CV?",
    noCvYet: "No CV uploaded yet.",
    analyze: "Analyze",
    aiRecommendations: "AI Recommendations",
    pasteBulletsPlaceholder: "Paste bullet points for live phrasing feedback...",
    weakPhrasing: "Weak Phrasing",
    noWeakPhrases: "No weak phrases detected",
    strongImpact: "Strong Impact",
    addImpactVerbs: "Add stronger impact verbs",
    templateSwitcherNote: "Template switcher: use AI Consultant export for PDF/DOCX generation.",
    selectCvFirst: "Select CV first",
    startSession: "Start Session",
    selectSession: "Select session",
    askPlaceholder: "Ask for interview prep, career strategy, CV improvements...",
    send: "Send",
                    marketTitle: "The Market",
    marketSubtitle: "Approved-only company discovery with culture signal preview.",
    marketSearchPlaceholder: "Search companies...",
    noCompaniesFound: "No companies found.",
    clearSearch: "Clear search",
    ratingPending: "Rating pending",
    viewCompany: "View details",
    viewAllJobs: "View all jobs",
    companyDetails: "Company details",
    companyOverview: "Overview",
    companyContact: "Contact",
    companyJobs: "Open roles",
    backToMarket: "Back to Market",
    companyEmail: "Email",
    companyPhone: "Phone",
    companyLoadFailed: "Failed to load company.",
    companyNotFound: "Company not found.",
    noJobsYet: "No jobs listed yet.",
    notProvided: "Not provided",
    filteredByCompany: "Filtered by company",
    noDescriptionYet: "No description yet",
    cultureScore: "Culture Score",
    consultantMarketplace: "Consultant Marketplace",
    consultingComingSoon: "Consulting coming soon",
    consultingComingSoonSubtitle: "Human consultant bookings are temporarily unavailable.",
    consultingComingSoonDetails: "We are onboarding verified consultants now. Check back soon to book a session.",
    generalConsulting: "General consulting",
    auditBookingTitle: "15-Min Audit Booking",
    selectConsultant: "Select consultant",
    auditGoalsPlaceholder: "Write your goals for this audit...",
    bookSlot: "Book 15-min Slot",
    bookedSuccess: "15-minute audit booked successfully.",
    bookingFailed: "Booking failed",
    consultantsLoadFailed: "Failed to load consultants.",
    selectConsultantAndTime: "Select consultant and start time",
    applicationsTitle: "Applications",
    applicationFallback: "Application",
    recentApplications: "Recent applications",
    viewAll: "View all",
    noApplicationsYet: "No applications yet.",
    savedJobs: "Saved Jobs",
    remove: "Remove",
    notifications: "Notifications",
    contact: "Contact",
    contactTitle: "Contact Us",
    contactSubtitle: "We read every message and respond quickly.",
    contactFormTitle: "Send a message",
    contactNote: "If you have a problem, saw an error, want to suggest features or enhancements, or need a mobile app/website, contact us.",
    contactTalentsEmail: "Talents email",
    contactDevEmail: "Developer email",
    contactSubject: "Title",
    contactMessage: "Message",
    contactSubjectPlaceholder: "Short title for your request",
    contactMessagePlaceholder: "Describe the issue, suggestion, or request...",
    contactSubjectFallback: "Support request",
    contactMessageFallback: "Hi Talents team,",
    contactSend: "Send email",
    contactEmailsTitle: "Emails",
    contactSocialTitle: "Follow us",
    contactSocialNote: "Social links will be added soon.",

    markAsRead: "Mark as Read",
    loading: "Loading",
    retry: "Retry",
    dashboardLoadFailed: "Failed to load dashboard data.",
    uploading: "Uploading CV...",
    
    cvUploadSuccess: "CV uploaded successfully.",
    cvUploadFailed: "Failed to upload CV.",
    cvAnalyzeFailed: "Could not analyze this CV right now. Please retry in a moment.",
    analyzingCv: "Analyzing CV...",
    analysisReady: "Analysis loaded successfully.",
    analysisPartial: "Partial analysis loaded. Some AI sections are unavailable.",
    retryAnalysis: "Retry Analysis",
    settingsSubtitle: "Manage language, theme, and account preferences.",
    language: "Language",
    theme: "Theme",
    themeDark: "Dark",
    themeLight: "Light",
    themePremium: "Premium",
    accountActions: "Account Actions",
    showAllNotifications: "Show all notifications",
    noNotificationsYet: "No notifications yet.",
    unread: "Unread",
    profileInfo: "Profile Information",
    cvAiInsights: "CV AI Insights",
    noAiInsightsYet: "No AI insights yet. Analyze your CV in CV Lab.",
    strengths: "Strengths",
    weaknesses: "Weaknesses",
    recommendations: "Recommendations",
    atsScore: "ATS Score",
    experienceYears: "Experience",
    keySkills: "Key Skills",
    yearsSuffix: "y",
        noData: "No data available.",
    sessionTitle: "Session title",
    titlePlaceholder: "e.g. CV draft for Google",
    saveTitle: "Save title",
    deleteSession: "Delete session",
    confirmDeleteSession: "Delete this session? This cannot be undone.",
    renameFailed: "Failed to rename session.",
    deleteFailed: "Failed to delete session.",
    insightsLoading: "Loading insights...",
    insightsFailed: "Failed to load insights.",
    insightsScore: "CV Score",
    insightsChecklist: "Checklist",
    insightsSummary: "Summary",
    insightsImprovements: "Improvements",
    insightsRequirements: "Job requirements",
    insightsStatusComplete: "CV is complete",
    insightsStatusInProgress: "CV is in progress",
    untitledSession: "Untitled session",
    recommendedJobs: "Recommended jobs",
  },
  ar: {
    appTitle: "Talents We Trust | ?????? ?? ???",
    pulse: "?????",
    opportunities: "????? ?????",
    cvLab: "????? ??????",
    aiConsultant: "???????? ?????",
    aiConsultantIntro: "???? ????? ?? ?????? ?????????? ?? ?????? ??????? ???????.",
    showSessions: "??? ???????",
    hideSessions: "????? ???????",
    previewEmpty: "???? ???????? ????? ?????.",
    exportDisabledHint: "?? ?????? ???????? ?????? ???????.",
    insightsEmpty: "????? ????? ??? ?? ???? ?????? ????????? ?????.",
    startCareerAdvisor: "?????? ????",
    startMockInterview: "?????? ???????",
    sessions: "???????",
    noSessionsYet: "?? ???? ????? ???. ???? ???? ????? ?????? ?????.",
    sessionLabelCareer: "?????? ????",
    sessionLabelMock: "?????? ???????",
    lastMessage: "??? ?????",
    chatPanel: "????????",
    insightsPanel: "?????",
    previewPanel: "?????? ??????",
    exportPanel: "?????",
    exportPdf: "????? PDF",
    exportDocx: "????? DOCX",
    exportFailed: "??? ???????. ???? ??? ????.",
    previewLoading: "???? ????? ????????...",
    previewFailed: "???????? ??? ?????.",
    startFailed: "??? ??? ??????.",
    sendFailed: "??? ????? ???????.",
    sessionsLoadFailed: "??? ????? ???????.",
    chatEmpty: "???? ???? ????? ?????? ????? ?? ?????? ?????????.",
    messageLabel: "??????",
    selectSessionHint: "???? ???? ????????.",
    market: "?????",
    consultants: "??? ??????????",
    applications: "???????",
    profile: "????? ??????",
    settings: "?????????",
    searchPlaceholder: "???? ?? ????? ?? ???? ?? ?????...",
    premiumUpgrade: "????? ???????",
    login: "????? ??????",
    register: "????? ????",
    forgotPassword: "???? ???? ??????",
    resetPassword: "????? ????? ???? ??????",
    email: "?????? ??????????",
    password: "???? ??????",
    fullName: "????? ??????",
    phone: "??????",
    submit: "?????",
    logout: "????? ??????",
    atsHealth: "??? ATS",
    applicationFunnel: "???? ???????",
    skillRadar: "????? ????????",
    quickApply: "????? ???? + ??? ???",
    aiStudio: "??????? ?????? ?????????",
    mockInterview: "??? ???????? ?????????",
    welcomeBack: "?????? ??????",
    accessWorkspace: "???? ??? ????? ?????? ?? ???.",
    createJobSeekerAccount: "????? ???? ???? ?? ???",
    registrationWorkflow: "?? ??????? ??? ??????? ?? ???? ????.",
    loginFailed: "??? ????? ??????",
    registrationFailed: "??? ???????",
    authFailed: "??? ?????",
    resetLinkSent: "??? ??? ?????? ??????? ????? ????? ???? ????? ???????.",
    passwordResetDone: "??? ????? ????? ???? ??????.",
    createAccount: "????? ????",
    alreadyHaveAccount: "???? ???? ???????",
    forgotPasswordQ: "?? ???? ???? ???????",
    sendResetLink: "????? ???? ????? ???????",
    haveTokenResetHere: "???? ????? ??????? ??? ??????? ???",
    resetToken: "??? ????? ???????",
    newPassword: "???? ?????? ???????",
    resetPasswordBtn: "????? ????? ???? ??????",
    backToLogin: "?????? ??? ????? ??????",
    authTagline: "???? ???? ????? ??????? ?????????",
    authHeadline: "???? ??????? ?????? ?? ???",
    authDescription: "???????? ????? ??????? ???????? ?????? ?????? ???????? ???? ??????.",
    goodMorning: "???? ?????",
    seeker: "????",
    profileMatchPrefix: "???? ?????",
    profileMatchMiddle: "??",
    profileMatchSuffix: "????? ?????.",
    goToCvLab: "الانتقال إلى مختبر السيرة",
    browseJobs: "تصفح الوظائف",
    startAiConsultant: "ابدأ المستشار الذكي",
    currentCvStrength: "??? ?????? ???????",
    applied: "?? ???????",
    interview: "??????",
    offer: "???",
    marketLabel: "?????",
    opportunitiesTitle: "????? ?????",
    opportunitiesSubtitle: "?????? ???? ?? ?????? ?? ??? ??????? ???????? ??????.",
    apply: "?????",
    viewDetails: "??? ????????",
    matchUnavailable: "???? ??????? ??????",
    jobsLoadFailed: "???? ????? ???????.",
    noJobsFound: "?? ???? ?????.",
    saved: "?? ?????",
    saveFailed: "???? ??? ???????.",
    jobDetailsFailed: "???? ????? ?????? ???????.",
    jobDescription: "?????",
    jobRequirements: "?????????",
    formLoadFailed: "???? ????? ????? ???????.",
    externalFormNote: "??? ??????? ?????? ????? ????? ?????.",
    openExternalForm: "??? ??????? ???????",
    selectOption: "???? ??????",
    fileFieldNote: "??? ?????? ?? ?????? (?? ???? ??? ???).",
    coverLetter: "???? ?????",
    coverLetterPlaceholder: "???? ???? ????? ???????...",
    chooseCv: "???? ??????",
    selectCv: "???? ????",
    cvRequired: "?????? ?????? ???? ?????.",
    submitApplication: "????? ?????",
    cancel: "?????",
    close: "?????",
    applicationSubmitted: "?? ????? ????? ?????.",
    applyFailed: "??? ????? ?????. ???? ??? ????.",
    fieldRequired: "??? ?????",


    uploadCvFirst: "???? ???? ????? ????? ?? ????? ??????",
    quickApplySuccess: "?? ??????? ?????? ?? ????? ?????.",
    quickApplyFailed: "??? ??????? ??????",
    match: "?????",
    company: "????",
    remote: "?? ????",
    save: "???",
    loadMore: "????? ??????",
    cvPreview: "?????? ??????",
    cvLabLeftHint: "????? ????? ?????? ???????? ?? ????? ??????? ????? ?????? ??? ?????? ???????.",
    cvLabRightHint: "???? ?????? ????? ??? ?????? ??? ??????? ????? ??? ???????.",
    cvTitle: "????? ??????",
    cvTitlePlaceholder: "????: ???? ???? Backend ??? - 2026",
    uploadCv: "??? ????",
    previewCv: "?????? ??????",
    deleteCv: "??? ??????",
    confirmDeleteCv: "?? ??? ????? ??? ???? ??? ??? ???????",
    noCvYet: "?? ???? ???? ?????? ??? ????.",
    analyze: "?????",
    aiRecommendations: "?????? ?????? ?????????",
    pasteBulletsPlaceholder: "???? ???? ?????? ?????? ??? ??????? ?????...",
    weakPhrasing: "????? ?????",
    noWeakPhrases: "?? ???? ?????? ?????",
    strongImpact: "????? ???",
    addImpactVerbs: "??? ????? ????? ????",
    templateSwitcherNote: "????? ???????: ?????? ????? ???????? ????? ??? PDF/DOCX.",
    selectCvFirst: "???? ???? ????? ?????",
    startSession: "??? ????",
    selectSession: "???? ????",
    askPlaceholder: "???? ?? ??????? ???????? ?? ????? ?????? ?? ?????????? ??????...",
    send: "?????",
                marketTitle: "السوق",
    marketSubtitle: "اكتشاف شركات معتمدة فقط مع لمحة الثقافة.",
    marketSearchPlaceholder: "ابحث عن الشركات…",
    noCompaniesFound: "لا توجد شركات.",
    clearSearch: "مسح البحث",
    ratingPending: "التقييم قيد الانتظار",
    viewCompany: "عرض التفاصيل",
    viewAllJobs: "عرض كل الوظائف",
    companyDetails: "تفاصيل الشركة",
    companyOverview: "نظرة عامة",
    companyContact: "التواصل",
    companyJobs: "وظائف متاحة",
    backToMarket: "العودة إلى السوق",
    companyEmail: "البريد الإلكتروني",
    companyPhone: "الهاتف",
    companyLoadFailed: "تعذر تحميل الشركة.",
    companyNotFound: "لم يتم العثور على شركة.",
    noJobsYet: "لا توجد وظائف بعد.",
    notProvided: "غير متوفر",
    filteredByCompany: "عرض وظائف شركة محددة",
    noDescriptionYet: "لا يوجد وصف بعد",
    cultureScore: "مؤشر الثقافة",
    consultantMarketplace: "??? ??????????",
    consultingComingSoon: "خدمة الاستشارات قريبًا",
    consultingComingSoonSubtitle: "حجوزات المستشارين البشريين غير متاحة مؤقتًا.",
    consultingComingSoonDetails: "نقوم بضم مستشارين معتمدين الآن. ارجع قريبًا لحجز جلسة.",
    generalConsulting: "??????? ????",
    auditBookingTitle: "??? ????? 15 ?????",
    selectConsultant: "???? ????????",
    auditGoalsPlaceholder: "???? ?????? ?? ??? ??????...",
    bookSlot: "???? 15 ?????",
    bookedSuccess: "?? ??? ???? 15 ????? ?????.",
    bookingFailed: "??? ?????",
    consultantsLoadFailed: "??? ????? ??????????.",
    selectConsultantAndTime: "???? ???????? ???? ???????",
    applicationsTitle: "???????",
    applicationFallback: "???",
    recentApplications: "أحدث الطلبات",
    viewAll: "عرض الكل",
    noApplicationsYet: "لا توجد طلبات بعد.",
    savedJobs: "??????? ????????",
    remove: "?????",
    notifications: "?????????",
    contact: "?????",
    contactTitle: "????? ????",
    contactSubtitle: "???? ?? ????? ???? ??????.",
    contactFormTitle: "???? ?????",
    contactNote: "??? ???? ????? ?? ????? ??? ?? ???? ?????? ????? ?? ??????? ?? ????? ????? ????/????? ????? ????.",
    contactTalentsEmail: "???? ??????",
    contactDevEmail: "???? ??????",
    contactSubject: "???????",
    contactMessage: "???????",
    contactSubjectPlaceholder: "????? ????? ?????",
    contactMessagePlaceholder: "???? ??????? ?? ???????? ?? ?????...",
    contactSubjectFallback: "??? ???",
    contactMessageFallback: "?????? ???? ???????",
    contactSend: "????? ??????",
    contactEmailsTitle: "??????",
    contactSocialTitle: "??????",
    contactSocialNote: "???? ????? ??????? ??????.",

    markAsRead: "????? ??????",
    loading: "???? ???????",
    uploading: "???? ??? ??????...",
    retry: "إعادة المحاولة",
    dashboardLoadFailed: "تعذر تحميل بيانات لوحة التحكم.",
    cvUploadSuccess: "?? ??? ?????? ?????.",
    cvUploadFailed: "??? ??? ??????.",
    cvAnalyzeFailed: "???? ????? ??? ?????? ????. ???? ??? ???? ??? ????.",
    analyzingCv: "???? ????? ??????...",
    analysisReady: "?? ????? ??????? ?????.",
    analysisPartial: "?? ????? ????? ????. ??? ????? ?????? ??? ?????.",
    retryAnalysis: "????? ????????",
    settingsSubtitle: "????? ????? ??????? ???????? ??????.",
    language: "?????",
    theme: "??????",
    themeDark: "????",
    themeLight: "????",
    themePremium: "???????",
    accountActions: "??????? ??????",
    showAllNotifications: "??? ?? ?????????",
    noNotificationsYet: "?? ???? ??????? ??????.",
    unread: "??? ?????",
    profileInfo: "??????? ????? ??????",
    cvAiInsights: "??? ?????? ????????? ??????",
    noAiInsightsYet: "?? ???? ??? ???. ?? ?????? ????? ?? ????? ??????.",
    strengths: "???? ?????",
    weaknesses: "???? ?????",
    recommendations: "????????",
        noData: "لا توجد بيانات.",
    sessionTitle: "عنوان الجلسة",
    titlePlaceholder: "مثال: مسودة سيرة لمهندس في جوجل",
    saveTitle: "حفظ العنوان",
    deleteSession: "حذف الجلسة",
    confirmDeleteSession: "هل تريد حذف هذه الجلسة؟ لا يمكن التراجع.",
    renameFailed: "تعذر تغيير العنوان.",
    deleteFailed: "تعذر حذف الجلسة.",
    insightsLoading: "جارٍ تحميل الرؤى...",
    insightsFailed: "تعذر تحميل الرؤى.",
    insightsScore: "درجة السيرة",
    insightsChecklist: "قائمة التحسين",
    insightsSummary: "الملخص",
    insightsImprovements: "تحسينات مقترحة",
    insightsRequirements: "متطلبات الوظيفة",
    insightsStatusComplete: "السيرة مكتملة",
    insightsStatusInProgress: "السيرة قيد الإعداد",
    untitledSession: "جلسة بدون عنوان",
    recommendedJobs: "وظائف مقترحة",
  },
};

const LanguageContext = createContext<LanguageContextValue | null>(null);
const KEY = "twt_seeker_language";

export const LanguageProvider: React.FC<React.PropsWithChildren> = ({ children }) => {
  const [language, setLanguage] = useState<Language>(() => {
    const stored = localStorage.getItem(KEY);
    return stored === "ar" ? "ar" : "en";
  });

  useEffect(() => {
    document.documentElement.lang = language;
    document.documentElement.dir = language === "ar" ? "rtl" : "ltr";
    localStorage.setItem(KEY, language);
  }, [language]);

  const value = useMemo(
    () => ({
      language,
      setLanguage,
      t: (key: string) => dictionary[language][key] || key,
    }),
    [language]
  );

  return <LanguageContext.Provider value={value}>{children}</LanguageContext.Provider>;
};

export const useLanguage = () => {
  const ctx = useContext(LanguageContext);
  if (!ctx) throw new Error("useLanguage must be used inside LanguageProvider");
  return ctx;
};

















